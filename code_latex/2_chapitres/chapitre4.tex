\chapter{Protocole d'Analyse : Sélection d'une Méthode d'Agrégation}

Ce chapitre a pour objectif de définir et de mettre en œuvre un protocole d'analyse rigoureux visant à sélectionner la méthode d'agrégation la plus adaptée à notre étude. Le choix s'appuiera sur une évaluation comparative de plusieurs approches candidates, en considérant des critères clés tels que la fidélité des indicateurs prudentiels (BE et SCR), la performance en termes de temps de calcul et la complexité de mise en œuvre.

La démarche consistera d'abord à présenter les différentes méthodes d'agrégation envisagées. Ensuite, nous appliquerons chacune de ces méthodes à un portefeuille de référence afin de quantifier les écarts de résultats par rapport à une modélisation sans agrégation.

À l'issue de cette analyse comparative, la méthode jugée la plus performante sera retenue. Elle sera ensuite utilisée pour conduire les analyses de sensibilité détaillées dans le chapitre suivant.

\section{Présentation des Méthodes d'Agrégation candidates}
    \subsection{Approches par clustering (K-means, DBSCAN/HDBSCAN)}
    % Votre texte ici...
    \subsection{Approche déterministe par regroupement de caractéristiques (Baseline)}
    
    Cette méthode, qui servira de point de comparaison (baseline) pour les algorithmes de clustering plus complexes, repose sur une approche déterministe classique en actuariat, souvent qualifiée de méthode "Grid-based" ou par cellules.

    Le principe fondamental consiste à partitionner l'univers des contrats en sous-ensembles disjoints (les cellules) définis par une combinaison unique de variables explicatives jugées prépondérantes pour le profil de risque. Contrairement aux méthodes de clustering qui cherchent des similarités statistiques, cette méthode applique une grille de lecture stricte. Dans le cadre de cette étude, les critères de regroupement retenus sont :
    \begin{itemize}
        \item Le sexe de l'assuré (variable catégorielle) ;
        \item Le Taux Minimum Garanti (TMG) (variable continue ou discrète selon les produits) ;
        \item L'âge de l'assuré (variable continue discrétisée à l'entier) ;
        \item L'ancienneté du contrat (variable continue discrétisée à l'entier).
    \end{itemize}

    Mathématiquement, cette méthode définit une relation d'équivalence entre deux contrats $i$ et $j$. Ils appartiennent au même \textit{Model Point} si et seulement si leurs vecteurs de caractéristiques discrétisées sont strictement identiques :
    $$ (\text{Sexe}_i, \lfloor \text{Age}_i \rfloor, \lfloor \text{Anciennet\'{e}}_i \rfloor, \text{TMG}_i) = (\text{Sexe}_j, \lfloor \text{Age}_j \rfloor, \lfloor \text{Anciennet\'{e}}_j \rfloor, \text{TMG}_j) $$

    L'agrégation s'opère ensuite par la sommation des variables extensives au sein de chaque groupe. La Provision Mathématique (PM) du \textit{Model Point} $k$ ainsi créé correspond à la somme exacte des PM des contrats le constituant :
    $$ PM_{MP_k} = \sum_{i \in Cellule_k} PM_i $$

    Cette approche présente l'avantage majeur de conserver exactement la volumétrie financière du portefeuille (aucune perte d'information sur le montant total des engagements) et de respecter scrupuleusement les garanties contractuelles comme le TMG. Elle garantit également une homogénéité parfaite des assurés au sein d'un groupe sur les critères choisis. Cependant, elle implique une discrétisation des variables temporelles (âge et ancienneté), ce qui peut introduire un léger biais d'arrondi lors des projections. De plus, le nombre de \textit{Model Points} résultant n'est pas fixé à l'avance mais dépend directement de la dispersion du portefeuille et de la granularité de la grille choisie, ce qui ne permet pas un contrôle direct sur le taux de compression final.

    \subsection{Approche par tranches (Banding) et moyenne pondérée}

    Cette méthode constitue une évolution de l'approche par cellules (baseline). Elle vise à réduire davantage le nombre de \textit{Model Points} en relâchant la contrainte d'égalité stricte sur les variables continues (âge et ancienneté) au profit d'une logique d'intervalles, communément appelée "Banding".

    Le principe de regroupement reste déterministe. Les variables catégorielles ou contractuelles majeures (Sexe, TMG) conservent une discrimination stricte. En revanche, l'espace des variables temporelles est découpé en tranches (ou \textit{bins}). Dans le cadre de cette implémentation, nous avons retenu :
    \begin{itemize}
        \item Un pas de 2 ans pour l'âge de l'assuré ;
        \item Un pas de 5 ans pour l'ancienneté du contrat.
    \end{itemize}

    Un contrat $i$ appartient à un groupe $k$ si ses caractéristiques discrètes correspondent et si ses variables continues tombent dans les intervalles définis :
    $$ i \in MP_k \iff \begin{cases} \text{Sexe}_i = \text{Sexe}_k \\ \text{TMG}_i = \text{TMG}_k \\ \text{Age}_i \in [\text{Age}_{min}^k, \text{Age}_{max}^k[ \\ \text{Anciennet\'{e}}_i \in [\text{Anc}_{min}^k, \text{Anc}_{max}^k[ \end{cases} $$

    La spécificité majeure de cette approche réside dans la détermination des caractéristiques du \textit{Model Point}. Contrairement à une approche simpliste qui retiendrait le centre de l'intervalle (par exemple, 31 ans pour la tranche [30-32[), cette méthode calcule le barycentre des contrats regroupés. Afin de préserver la structure financière du portefeuille, la moyenne est pondérée par la Provision Mathématique (PM).

    Ainsi, l'âge ($Age_{MP}$) et l'ancienneté ($Anc_{MP}$) du \textit{Model Point} sont calculés comme suit :
    $$ \text{Age}_{MP} = \frac{\sum_{i \in MP} \text{Age}_i \times \text{PM}_i}{\sum_{i \in MP} \text{PM}_i} \quad ; \quad \text{Anc}_{MP} = \frac{\sum_{i \in MP} \text{Anciennet\'{e}}_i \times \text{PM}_i}{\sum_{i \in MP} \text{PM}_i} $$

    Cette pondération par les encours permet de s'assurer que le \textit{Model Point} est représentatif des contrats les plus significatifs financièrement au sein de la tranche, minimisant ainsi le biais d'agrégation sur les projections de flux futurs.

    \subsection{Approches autres (mémoire Amine, etc.)}
\section{Définition du Protocole de Test Comparatif}
    \subsection{Constitution des portefeuilles de test}
    % Votre texte ici...
    \subsection{Définition des critères de sélection : fidélité des indicateurs (BE/SCR), performance et temps de calcul}
    % Votre texte ici...

\section{Analyse Comparative et Choix de la Méthode Optimale}
    \subsection{Synthèse des performances pour chaque méthode candidate}
    % Votre texte ici...
    \subsection{Justification du choix de la méthode retenue pour l'analyse de sensibilité}
    % Votre texte ici...
% \chapter{Protocole d'Analyse : Agrégation et Scénarios de Sensibilité}

% % Introduction du chapitre : Expliquer que ce chapitre pose toute la méthodologie
% % qui sera appliquée dans la partie suivante. C'est le "comment" de l'analyse.

% \section{Méthodologie et Sélection du Modèle d'Agrégation}
% % Objectif : Décrire le processus complet qui mène au choix d'UNE méthode d'agrégation.

% \subsection{Description des Méthodes d'Agrégation Candidates}
% % Reprendre votre description technique des méthodes (K-means, DBSCAN, etc.)

% \subsection{Tests de Performance et Analyse comparative}
% % Fusionner la présentation des portefeuilles de test et l'analyse
% \subsubsection{Présentation des portefeuilles de test}
% % Décrire les portefeuilles utilisés spécifiquement pour comparer les méthodes d'agrégation.

% \subsubsection{Critères d'évaluation et résultats des tests}
% % Analyser les résultats (BE, SCR, temps de calcul) pour chaque méthode.
% % Inclure ici la réflexion sur l'optimisation du nombre de Model Points.

% \subsection{Choix du Modèle d'Agrégation Optimal pour les métriques S2}
% % Conclure cette section en justifiant le choix d'UNE méthode spécifique
% % au regard des résultats précédents et de sa compatibilité avec les architectures modernes.

% \section{Définition des Scénarios de Sensibilité}
% % Objectif : Décrire précisément les tests qui seront menés sur les portefeuilles.

% \subsection{Création des Portefeuilles de Test via le Générateur}
% % Expliquer comment le générateur est utilisé pour créer les portefeuilles de base
% % ainsi que leurs variations pour les tests de sensibilité.

% \subsection{Description des Chocs et Modifications Appliqués}
% % Détailler les chocs (positifs/négatifs) sur les variables clés.
% % Décrire le scénario d'ajout d'un nouveau produit (caractéristiques, volume, etc.).
